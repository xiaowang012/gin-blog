{{ define "article/write.html" }}
<!DOCTYPE html>
<html>
  <head>
    <title>Blog-编辑</title>
    <link rel="icon" href="../../static/imgs/index/title.png" type="image/x-icon"> 
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
    <link href="./static/summernote/summernote.min.css" rel="stylesheet">
    <script src="./static/summernote/summernote.min.js"></script>
</head>
    <body>
        <script type="text/javascript">  
            function return_confirm(url)
            {
            var r=confirm("您确定要返回首页吗?文章将会丢弃!")
            if(r){window.location.href=url
            }
            }
            $(document).ready(function() {
                $('#summernote').summernote();
            }); 
            $('.summernote').summernote({
                fontNames: ['Arial', 'Arial Black', 'Comic Sans MS', 'Courier New', 'Georgia', 'Georgia2', 'Merriweather'],
                fontNamesIgnoreCheck:['Georgia'],
                height : 400,
                lang : 'zh-CN',
                callbacks: {
                    onImageUpload: function (files) {
                        sendFile(files[0], this);
                    }
                },
                toolbar: [
                    ['style', ['style']],
                    ['font', ['bold', 'italic', 'underline', 'clear', 'strikethrough', 'subscript', 'superscript']],
                    ['fontsize',['fontsize']],
                    ['fontname', ['fontname']],
                    ['color', ['color']],
                    ['para', ['ul', 'ol', 'paragraph']],
                    ['height', ['height']],
                    ['insert', ['table', 'link', 'picture', 'video', 'hr']],
                    ['view', ['fullscreen', 'codeview', 'help', 'preview']],
                ],
            });


            //上传图片
            function sendFile(files,editor,$editable) {
                var formData=new FormData();
                formData.append('files',files[0]);
                $.ajax({
                    url:'/opms/noticeInfo/uploadImage',
                    type:'post',
                    data:formData,
                    cache:false,
                    contentType: false,
                    processData:false,
                    dataType: 'json',
                    success:function (data) {
                        if (data.success==true){
                            //data是返回的hash,key之类的值，key是定义的文件名
                            editor.insertImage($editable,data.img);
                        }else{
                            swal('系统提示','图片上传失败','warning');
                        }
                    },
                    error:function () {
                        swal('系统提示','图片上传失败','error');
                    }
                });
            } 
        </script>  
            <div class="container">
                <div class="row clearfix">
                    <div class="col-md-12 column">
                        <div style="text-align: center;" class="page-header">
                            <h1 >
                                编写文章 <small></small>
                            </h1>
                        </div>
                        <!-- 消息提醒 -->
                        <div style="margin-top: 10px;" class= "{{ .style }}">
                            <button type="button" class="close" data-dismiss="alert" aria-hidden="true"></button>
                                <strong>{{ .msg }}&nbsp&nbsp</strong>   
                        </div>
                        <form role="form" action="/index/WriteArticle" method="post">
                            <div class="form-group">
                                <label for="Author"></label><input  type="text" placeholder="作者" style="background: rgba(255,255,255,0.5);"  class="form-control" name="Author"  value="{{ .currentUser }}" readonly="readonly" />
                            </div>
                            <div class="form-group">
                                 <label for="BlogTitle"></label><input  type="text" placeholder="输入文章标题" style="background: rgba(255,255,255,0.5);"  class="form-control" name="BlogTitle"  />
                            </div>
                            <div class="form-group">
                                <textarea class="summernote" id="summernote">请输入文章内容</textarea>
                            </div>
                            <div class="checkbox">
                                <label style="color: red;font-size: medium;" ><input  name="anonymous" type="checkbox" />是否匿名(如果选择匿名发布文章,系统将不会保存您的用户信息,匿名存入数据库,在个人中心无法查看,将失去这篇文章的控制权!)</label>
                            </div>
                            <button type="submit" class="btn btn-primary">发布</button>  
                            <button role="button" onclick="return_confirm('/index')" type="button"  class="btn btn-default">返回</button>
                        </form>
                        
                        
                    </div>
                </div>
            </div>
        </div>     
    </body>
</html>
{{ end }}




